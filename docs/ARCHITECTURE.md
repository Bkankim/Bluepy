# BluePy 2.0 - ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë¬¸ì„œ

**ì‘ì„±ì¼**: 2025-10-17
**ë²„ì „**: 1.0
**ìƒíƒœ**: Draft

---

## ëª©ì°¨

1. [ì•„í‚¤í…ì²˜ ê°œìš”](#1-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ì„¤ê³„ ì›ì¹™](#2-ì„¤ê³„-ì›ì¹™)
3. [ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°](#3-ì „ì²´-ì‹œìŠ¤í…œ-êµ¬ì¡°)
4. [í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°](#4-í”„ë¡œì íŠ¸-í´ë”-êµ¬ì¡°)
5. [í•µì‹¬ ëª¨ë“ˆ ì„¤ê³„](#5-í•µì‹¬-ëª¨ë“ˆ-ì„¤ê³„)
6. [ë°ì´í„° ëª¨ë¸](#6-ë°ì´í„°-ëª¨ë¸)
7. [ê·œì¹™ ì‹œìŠ¤í…œ](#7-ê·œì¹™-ì‹œìŠ¤í…œ)
8. [í†µì‹  ë° ë„¤íŠ¸ì›Œí¬](#8-í†µì‹ -ë°-ë„¤íŠ¸ì›Œí¬)
9. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#9-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
10. [ë³´ì•ˆ ì„¤ê³„](#10-ë³´ì•ˆ-ì„¤ê³„)
11. [í™•ì¥ì„± ì „ëµ](#11-í™•ì¥ì„±-ì „ëµ)
12. [ì„±ëŠ¥ ìµœì í™”](#12-ì„±ëŠ¥-ìµœì í™”)

---

## 1. ì•„í‚¤í…ì²˜ ê°œìš”

### 1.1 ì•„í‚¤í…ì²˜ íŒ¨í„´

BluePy 2.0ì€ **Clean Architecture** (Hexagonal Architecture)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Presentation Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   GUI        â”‚  â”‚     CLI      â”‚  â”‚    REST API      â”‚  â”‚
â”‚  â”‚  (PySide6)   â”‚  â”‚   (Click)    â”‚  â”‚   (FastAPI)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Application Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            Use Cases (Business Logic)                â”‚   â”‚
â”‚  â”‚  â€¢ ScanServer    â€¢ AnalyzeResults   â€¢ AutoRemediate â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Domain Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚             Domain Entities & Logic                  â”‚   â”‚
â”‚  â”‚  â€¢ CheckItem  â€¢ ScanResult  â€¢ RemediationAction     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Infrastructure Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Database   â”‚ â”‚   Network    â”‚ â”‚    Reporting       â”‚   â”‚
â”‚  â”‚  (SQLite)   â”‚ â”‚ (SSH/WinRM)  â”‚ â”‚  (PDF/Excel/HTML)  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ì£¼ìš” íŠ¹ì§•

**ê³„ì¸µ ë¶„ë¦¬**:
- ê° ê³„ì¸µì€ ëª…í™•í•œ ì±…ì„ì„ ê°€ì§
- ì˜ì¡´ì„±ì€ ì™¸ë¶€ â†’ ë‚´ë¶€ë§Œ ê°€ëŠ¥ (Dependency Inversion)
- Infrastructure ê³„ì¸µì€ Domainì„ ì˜ì¡´í•˜ì§€ë§Œ, Domainì€ Infrastructureë¥¼ ëª¨ë¦„

**í™•ì¥ì„±**:
- ìƒˆë¡œìš´ í”Œë«í¼ ì¶”ê°€ ìš©ì´ (Linux, macOS, Windows, Docker ë“±)
- ê·œì¹™ ê¸°ë°˜ ì‹œìŠ¤í…œ (YAML íŒŒì¼ë¡œ ì ê²€ í•­ëª© ì •ì˜)
- í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ (ì»¤ìŠ¤í…€ ì ê²€ ê·œì¹™ ì¶”ê°€)

**í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±**:
- ê° ê³„ì¸µì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- Mock ê°ì²´ë¡œ ì™¸ë¶€ ì˜ì¡´ì„± ì œê±°
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸ ë¶„ë¦¬

---

## 2. ì„¤ê³„ ì›ì¹™

### 2.1 SOLID ì›ì¹™

#### Single Responsibility Principle (ë‹¨ì¼ ì±…ì„)
ê° í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì§

```python
# Good: ì±…ì„ ë¶„ë¦¬
class Scanner:
    """ì ê²€ ì‹¤í–‰ë§Œ ë‹´ë‹¹"""
    def scan(self): pass

class Analyzer:
    """ê²°ê³¼ ë¶„ì„ë§Œ ë‹´ë‹¹"""
    def analyze(self, scan_result): pass

class Reporter:
    """ë³´ê³ ì„œ ìƒì„±ë§Œ ë‹´ë‹¹"""
    def generate_report(self, analyzed_data): pass
```

#### Open-Closed Principle (ê°œë°©-íì‡„)
í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³  ìˆ˜ì •ì—ëŠ” ë‹«í˜€ìˆìŒ

```python
# Good: í™•ì¥ ê°€ëŠ¥
class BaseScanner(ABC):
    @abstractmethod
    def scan(self): pass

class LinuxScanner(BaseScanner):
    def scan(self): pass  # Linux êµ¬í˜„

class MacOSScanner(BaseScanner):
    def scan(self): pass  # macOS êµ¬í˜„ - ê¸°ì¡´ ì½”ë“œ ìˆ˜ì • ì—†ìŒ
```

#### Liskov Substitution Principle (ë¦¬ìŠ¤ì½”í”„ ì¹˜í™˜)
í•˜ìœ„ íƒ€ì…ì€ ìƒìœ„ íƒ€ì…ì„ ëŒ€ì²´ ê°€ëŠ¥

```python
def run_scan(scanner: BaseScanner):
    """ì–´ë–¤ Scannerë“  ë™ì‘ ê°€ëŠ¥"""
    result = scanner.scan()
    return result

# LinuxScanner, MacOSScanner ëª¨ë‘ ê°€ëŠ¥
```

#### Interface Segregation Principle (ì¸í„°í˜ì´ìŠ¤ ë¶„ë¦¬)
í´ë¼ì´ì–¸íŠ¸ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ

```python
# Good: ì‘ê³  ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤
class Scannable(Protocol):
    def scan(self) -> ScanResult: ...

class Remediable(Protocol):
    def remediate(self, item: CheckItem) -> bool: ...

# Bad: ê±°ëŒ€í•œ ì¸í„°í˜ì´ìŠ¤
class AllInOne(Protocol):
    def scan(self): ...
    def remediate(self): ...
    def report(self): ...  # ì ê²€ë§Œ í•„ìš”í•œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¶ˆí•„ìš”
```

#### Dependency Inversion Principle (ì˜ì¡´ì„± ì—­ì „)
ê³ ìˆ˜ì¤€ ëª¨ë“ˆì€ ì €ìˆ˜ì¤€ ëª¨ë“ˆì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ë‘˜ ë‹¤ ì¶”ìƒí™”ì— ì˜ì¡´

```python
# Good: ì¶”ìƒí™”ì— ì˜ì¡´
class ScanUseCase:
    def __init__(self, scanner: BaseScanner, reporter: BaseReporter):
        self.scanner = scanner  # êµ¬ì²´ì  í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ì¶”ìƒ í´ë˜ìŠ¤
        self.reporter = reporter

# Bad: êµ¬ì²´ì  í´ë˜ìŠ¤ì— ì˜ì¡´
class ScanUseCase:
    def __init__(self):
        self.scanner = LinuxScanner()  # í•˜ë“œì½”ë”©
```

### 2.2 ì¶”ê°€ ì„¤ê³„ ì›ì¹™

**DRY (Don't Repeat Yourself)**:
- Unix ê³µí†µ ë¡œì§ì€ `UnixScanner`ì— ì¶”ìƒí™”
- ë°˜ë³µë˜ëŠ” íŒ¨í„´ì€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¡œ ì¶”ì¶œ

**KISS (Keep It Simple, Stupid)**:
- ê³¼ë„í•œ ì¶”ìƒí™” ì§€ì–‘
- ëª…í™•í•˜ê³  ì½ê¸° ì‰¬ìš´ ì½”ë“œ

**YAGNI (You Aren't Gonna Need It)**:
- í˜„ì¬ í•„ìš”í•œ ê¸°ëŠ¥ë§Œ êµ¬í˜„
- ë¯¸ë˜ë¥¼ ìœ„í•œ ê³¼ë„í•œ ì„¤ê³„ ì§€ì–‘

---

## 3. ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

### 3.1 ì»´í¬ë„ŒíŠ¸ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BluePy 2.0 Application                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     GUI Layer (PySide6)                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ Dashboard  â”‚ â”‚ Scan View  â”‚ â”‚ Result/History View   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ - ì ìˆ˜     â”‚ â”‚ - ì„œë²„ì„ íƒ â”‚ â”‚ - íŠ¸ë¦¬ë·°              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ - ì°¨íŠ¸     â”‚ â”‚ - ì‹¤í–‰     â”‚ â”‚ - ìƒì„¸ì •ë³´            â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚               Application Services                     â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ ScanService      â”‚ â”‚ RemediationService         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - scan_server()  â”‚ â”‚ - auto_fix()              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ - get_results()  â”‚ â”‚ - rollback()              â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Core Domain                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ Scanner  â”‚  â”‚ Analyzer  â”‚  â”‚ Remediator       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ - Base   â”‚  â”‚ - Parser  â”‚  â”‚ - Backup         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ - Unix   â”‚  â”‚ - Risk    â”‚  â”‚ - Execute        â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ - Linux  â”‚  â”‚ - Trend   â”‚  â”‚ - Rollback       â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ - macOS  â”‚  â”‚           â”‚  â”‚                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚ - Win    â”‚  â”‚           â”‚  â”‚                  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                Infrastructure                          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  DB       â”‚  â”‚ Network   â”‚  â”‚  Reporting       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Repo     â”‚  â”‚ SSH       â”‚  â”‚  PDF/Excel/HTML  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  SQLite   â”‚  â”‚ WinRM     â”‚  â”‚                  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

              External Resources
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Rules   â”‚  â”‚ Servers  â”‚  â”‚  Reports â”‚
    â”‚  YAML    â”‚  â”‚ SSH/WinRMâ”‚  â”‚  Files   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ë°ì´í„° í”Œë¡œìš°

```
ì‚¬ìš©ì ì•¡ì…˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. GUI: ìŠ¤ìº” ì‹œì‘ ë²„íŠ¼ í´ë¦­                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ScanService: scan_server(server_id, platform)         â”‚
â”‚    - ì„œë²„ ì •ë³´ ì¡°íšŒ (DB)                                  â”‚
â”‚    - Scanner íŒ©í† ë¦¬ë¡œ ì ì ˆí•œ Scanner ìƒì„±                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Scanner: ì ê²€ ì‹¤í–‰                                     â”‚
â”‚    - SSH/WinRM ì—°ê²°                                       â”‚
â”‚    - ê·œì¹™ íŒŒì¼(YAML) ë¡œë“œ                                â”‚
â”‚    - ì ê²€ ëª…ë ¹ì–´ ì‹¤í–‰ (ë¹„ë™ê¸°)                           â”‚
â”‚    - ì›ì‹œ ê²°ê³¼ ìˆ˜ì§‘                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Analyzer: ê²°ê³¼ ë¶„ì„                                    â”‚
â”‚    - ëª…ë ¹ì–´ ê²°ê³¼ íŒŒì‹±                                     â”‚
â”‚    - ê·œì¹™ ê¸°ë°˜ ê²€ì¦ (YAML validator)                     â”‚
â”‚    - ìœ„í—˜ë„ ê³„ì‚° (high/medium/low)                       â”‚
â”‚    - ScanResult ê°ì²´ ìƒì„±                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Repository: ê²°ê³¼ ì €ì¥                                  â”‚
â”‚    - ScanResult â†’ DB (SQLite)                            â”‚
â”‚    - ì´ë ¥ ê¸°ë¡                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. GUI: ê²°ê³¼ í‘œì‹œ                                         â”‚
â”‚    - íŠ¸ë¦¬ ë·° ì—…ë°ì´íŠ¸                                     â”‚
â”‚    - ìƒ‰ìƒ ì½”ë“œ í‘œì‹œ                                       â”‚
â”‚    - í†µê³„ ì—…ë°ì´íŠ¸                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
           (ì‚¬ìš©ìê°€ ìë™ ìˆ˜ì • ì„ íƒ ì‹œ)
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. RemediationService: ìë™ ìˆ˜ì •                          â”‚
â”‚    - ë°±ì—… ìƒì„± (BackupManager)                           â”‚
â”‚    - Dry-run ì‹œë®¬ë ˆì´ì…˜                                  â”‚
â”‚    - ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ                                        â”‚
â”‚    - ì‚¬ìš©ì í™•ì¸                                          â”‚
â”‚    - ì‹¤ì œ ìˆ˜ì • ì‹¤í–‰                                       â”‚
â”‚    - ê²€ì¦                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Reporter: ë³´ê³ ì„œ ìƒì„±                                  â”‚
â”‚    - PDF/Excel/HTML ìƒì„±                                 â”‚
â”‚    - ì´ë©”ì¼ ë°œì†¡ (ì„ íƒ)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°

### 4.1 ì „ì²´ êµ¬ì¡°

```
bluepy/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                       # í”„ë¡œì íŠ¸ ì†Œê°œ
â”œâ”€â”€ ğŸ“„ PROJECT_PLAN.md                 # í”„ë¡œì íŠ¸ ê³„íšì„œ
â”œâ”€â”€ ğŸ“„ CLAUDE.md                       # AI ì‘ì—… ì§€ì¹¨
â”œâ”€â”€ ğŸ“„ requirements.txt                # Python ì˜ì¡´ì„±
â”œâ”€â”€ ğŸ“„ pyproject.toml                  # í”„ë¡œì íŠ¸ ë©”íƒ€ë°ì´í„°
â”œâ”€â”€ ğŸ“„ setup.py                        # íŒ¨í‚¤ì§€ ì„¤ì •
â”œâ”€â”€ ğŸ“„ .gitignore
â”œâ”€â”€ ğŸ“„ .env.example                    # í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”‚
â”œâ”€â”€ ğŸ“‚ src/                            # ì†ŒìŠ¤ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ __main__.py                    # ì§„ì…ì  (python -m src)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ core/                       # ğŸ§  í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ domain/                 # ë„ë©”ì¸ ëª¨ë¸
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ check_item.py         # ì ê²€ í•­ëª© ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ scan_result.py        # ìŠ¤ìº” ê²°ê³¼ ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ remediation_action.py # ìˆ˜ì • ì¡°ì¹˜ ì—”í‹°í‹°
â”‚   â”‚   â”‚   â”œâ”€â”€ server.py              # ì„œë²„ ì—”í‹°í‹°
â”‚   â”‚   â”‚   â””â”€â”€ enums.py               # Severity, Status ë“± Enum
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ scanner/                # ìŠ¤ìº” ì—”ì§„
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ base_scanner.py       # ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ unix_scanner.py       # Unix ê³µí†µ (Linux + macOS)
â”‚   â”‚   â”‚   â”œâ”€â”€ linux_scanner.py      # Linux íŠ¹í™”
â”‚   â”‚   â”‚   â”œâ”€â”€ macos_scanner.py      # macOS íŠ¹í™”
â”‚   â”‚   â”‚   â”œâ”€â”€ windows_scanner.py    # Windows íŠ¹í™”
â”‚   â”‚   â”‚   â”œâ”€â”€ scanner_factory.py    # íŒ©í† ë¦¬ íŒ¨í„´
â”‚   â”‚   â”‚   â””â”€â”€ rule_loader.py        # YAML ê·œì¹™ ë¡œë”
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ analyzer/               # ë¶„ì„ ì—”ì§„
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ result_parser.py      # ëª…ë ¹ì–´ ê²°ê³¼ íŒŒì‹±
â”‚   â”‚   â”‚   â”œâ”€â”€ validator.py          # ê·œì¹™ ê¸°ë°˜ ê²€ì¦
â”‚   â”‚   â”‚   â”œâ”€â”€ risk_calculator.py    # ìœ„í—˜ë„ ê³„ì‚°
â”‚   â”‚   â”‚   â””â”€â”€ trend_analyzer.py     # íŠ¸ë Œë“œ ë¶„ì„
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“‚ remediation/            # ìë™ ìˆ˜ì • ì—”ì§„
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ base_remediator.py    # ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚       â”œâ”€â”€ unix_remediator.py    # Unix ê³µí†µ
â”‚   â”‚       â”œâ”€â”€ linux_remediator.py   # Linux íŠ¹í™”
â”‚   â”‚       â”œâ”€â”€ macos_remediator.py   # macOS íŠ¹í™”
â”‚   â”‚       â”œâ”€â”€ windows_remediator.py # Windows íŠ¹í™”
â”‚   â”‚       â”œâ”€â”€ backup_manager.py     # ë°±ì—… ê´€ë¦¬
â”‚   â”‚       â””â”€â”€ rollback_manager.py   # ë¡¤ë°± ê´€ë¦¬
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ application/                # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ (Use Cases)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ scan_service.py           # ìŠ¤ìº” ê´€ë ¨ Use Case
â”‚   â”‚   â”œâ”€â”€ remediation_service.py    # ìˆ˜ì • ê´€ë ¨ Use Case
â”‚   â”‚   â”œâ”€â”€ report_service.py         # ë³´ê³ ì„œ ê´€ë ¨ Use Case
â”‚   â”‚   â””â”€â”€ server_service.py         # ì„œë²„ ê´€ë¦¬ Use Case
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ gui/                        # ğŸ–¥ï¸ PySide6 GUI
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ app.py                    # QApplication ì§„ì…ì 
â”‚   â”‚   â”œâ”€â”€ main_window.py            # ë©”ì¸ ìœˆë„ìš°
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ views/                 # í™”ë©´ (QWidget)
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard_view.py    # ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â”‚   â”œâ”€â”€ server_view.py       # ì„œë²„ ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ scan_view.py         # ìŠ¤ìº” ì‹¤í–‰
â”‚   â”‚   â”‚   â”œâ”€â”€ result_view.py       # ê²°ê³¼ ì¡°íšŒ
â”‚   â”‚   â”‚   â”œâ”€â”€ history_view.py      # ì´ë ¥ ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ settings_view.py     # ì„¤ì •
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ widgets/               # ì¬ì‚¬ìš© ìœ„ì ¯
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ server_card.py       # ì„œë²„ ì¹´ë“œ
â”‚   â”‚   â”‚   â”œâ”€â”€ check_item_tree.py   # ì ê²€ í•­ëª© íŠ¸ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ progress_widget.py   # ì§„í–‰ë¥  í‘œì‹œ
â”‚   â”‚   â”‚   â”œâ”€â”€ chart_widget.py      # ì°¨íŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ log_viewer.py        # ë¡œê·¸ ë·°ì–´
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ dialogs/               # ëŒ€í™”ìƒì
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ server_dialog.py     # ì„œë²„ ì¶”ê°€/í¸ì§‘
â”‚   â”‚   â”‚   â”œâ”€â”€ remediation_dialog.py # ìˆ˜ì • ë¯¸ë¦¬ë³´ê¸°
â”‚   â”‚   â”‚   â””â”€â”€ about_dialog.py      # ì •ë³´
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“‚ resources/             # UI ë¦¬ì†ŒìŠ¤
â”‚   â”‚       â”œâ”€â”€ icons/                # ì•„ì´ì½˜ íŒŒì¼
â”‚   â”‚       â”œâ”€â”€ styles.qss            # Qt ìŠ¤íƒ€ì¼ì‹œíŠ¸
â”‚   â”‚       â””â”€â”€ ui_files/             # Qt Designer íŒŒì¼ (ì„ íƒ)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ cli/                       # CLI ì¸í„°í˜ì´ìŠ¤ (ì„ íƒ)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ commands.py               # Click ëª…ë ¹ì–´
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ infrastructure/            # ì¸í”„ë¼ ê³„ì¸µ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ database/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ connection.py        # DB ì—°ê²° ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ models.py             # SQLAlchemy ORM ëª¨ë¸
â”‚   â”‚   â”‚   â”œâ”€â”€ repositories/         # Repository íŒ¨í„´
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ scan_repository.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ server_repository.py
â”‚   â”‚   â”‚   â””â”€â”€ migrations/           # Alembic ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ğŸ“‚ network/
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ ssh_client.py        # AsyncSSH ë˜í¼
â”‚   â”‚   â”‚   â”œâ”€â”€ winrm_client.py      # PyWinRM ë˜í¼
â”‚   â”‚   â”‚   â””â”€â”€ connection_pool.py   # ì—°ê²° í’€ ê´€ë¦¬
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ ğŸ“‚ reporting/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ base_reporter.py     # ì¶”ìƒ í´ë˜ìŠ¤
â”‚   â”‚       â”œâ”€â”€ pdf_reporter.py      # PDF ìƒì„± (ReportLab)
â”‚   â”‚       â”œâ”€â”€ excel_reporter.py    # Excel ìƒì„± (openpyxl)
â”‚   â”‚       â”œâ”€â”€ html_reporter.py     # HTML ìƒì„± (Jinja2)
â”‚   â”‚       â””â”€â”€ email_sender.py      # ì´ë©”ì¼ ë°œì†¡
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ utils/                     # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ logger.py                 # ë¡œê¹… ì„¤ì •
â”‚       â”œâ”€â”€ config.py                 # ì„¤ì • ê´€ë¦¬
â”‚       â”œâ”€â”€ validators.py             # ì…ë ¥ ê²€ì¦
â”‚       â”œâ”€â”€ crypto.py                 # ì•”í˜¸í™” (í¬ë ˆë´ì…œ)
â”‚       â””â”€â”€ exceptions.py             # ì»¤ìŠ¤í…€ ì˜ˆì™¸
â”‚
â”œâ”€â”€ ğŸ“‚ config/                        # âš™ï¸ ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ default.yaml                  # ê¸°ë³¸ ì„¤ì •
â”‚   â”œâ”€â”€ servers.yaml                  # ì„œë²„ ëª©ë¡
â”‚   â”œâ”€â”€ logging.yaml                  # ë¡œê¹… ì„¤ì •
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ rules/                     # ì ê²€ ê·œì¹™ (YAML)
â”‚       â”œâ”€â”€ ğŸ“‚ linux/
â”‚       â”‚   â”œâ”€â”€ account.yaml          # ê³„ì • ê´€ë¦¬ (15ê°œ)
â”‚       â”‚   â”œâ”€â”€ filesystem.yaml       # íŒŒì¼/ë””ë ‰í„°ë¦¬ (20ê°œ)
â”‚       â”‚   â”œâ”€â”€ service.yaml          # ì„œë¹„ìŠ¤ (35ê°œ)
â”‚       â”‚   â”œâ”€â”€ patch.yaml            # íŒ¨ì¹˜ (1ê°œ)
â”‚       â”‚   â””â”€â”€ log.yaml              # ë¡œê·¸ (2ê°œ)
â”‚       â”‚
â”‚       â”œâ”€â”€ ğŸ“‚ macos/
â”‚       â”‚   â”œâ”€â”€ account.yaml
â”‚       â”‚   â”œâ”€â”€ filesystem.yaml
â”‚       â”‚   â”œâ”€â”€ system.yaml           # SIP, Gatekeeper ë“±
â”‚       â”‚   â””â”€â”€ network.yaml
â”‚       â”‚
â”‚       â””â”€â”€ ğŸ“‚ windows/
â”‚           â”œâ”€â”€ account.yaml
â”‚           â”œâ”€â”€ registry.yaml
â”‚           â”œâ”€â”€ service.yaml
â”‚           â””â”€â”€ firewall.yaml
â”‚
â”œâ”€â”€ ğŸ“‚ data/                          # ë°ì´í„° ì €ì¥ì†Œ (Git ì œì™¸)
â”‚   â”œâ”€â”€ ğŸ“‚ databases/
â”‚   â”‚   â””â”€â”€ bluepy.db                 # SQLite íŒŒì¼
â”‚   â”œâ”€â”€ ğŸ“‚ reports/                   # ìƒì„±ëœ ë³´ê³ ì„œ
â”‚   â””â”€â”€ ğŸ“‚ backups/                   # ë°±ì—… íŒŒì¼
â”‚
â”œâ”€â”€ ğŸ“‚ tests/                         # í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py                   # pytest ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ unit/                      # ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
â”‚   â”‚   â”œâ”€â”€ test_scanner.py
â”‚   â”‚   â”œâ”€â”€ test_analyzer.py
â”‚   â”‚   â”œâ”€â”€ test_remediation.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“‚ integration/               # í†µí•© í…ŒìŠ¤íŠ¸
â”‚   â”‚   â”œâ”€â”€ test_scan_workflow.py
â”‚   â”‚   â”œâ”€â”€ test_remediation_workflow.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ“‚ fixtures/                  # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â”‚       â”œâ”€â”€ sample_rules.yaml
â”‚       â””â”€â”€ mock_responses.json
â”‚
â”œâ”€â”€ ğŸ“‚ scripts/                       # ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ migrate_legacy.py             # ê¸°ì¡´ ì½”ë“œ ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â”œâ”€â”€ import_rules.py               # ê·œì¹™ ê°€ì ¸ì˜¤ê¸°
â”‚   â”œâ”€â”€ build.py                      # PyInstaller ë¹Œë“œ
â”‚   â””â”€â”€ setup_dev.sh                  # ê°œë°œ í™˜ê²½ ì„¤ì •
â”‚
â”œâ”€â”€ ğŸ“‚ docs/                          # ë¬¸ì„œ
â”‚   â”œâ”€â”€ ARCHITECTURE.md               # ì´ ë¬¸ì„œ
â”‚   â”œâ”€â”€ ROADMAP.md                    # ê°œë°œ ë¡œë“œë§µ
â”‚   â”œâ”€â”€ LEGACY_ANALYSIS.md            # ê¸°ì¡´ ì‹œìŠ¤í…œ ë¶„ì„
â”‚   â”œâ”€â”€ PLATFORM_DETAILS.md           # í”Œë«í¼ë³„ ìƒì„¸
â”‚   â”œâ”€â”€ USER_MANUAL.md                # ì‚¬ìš©ì ë§¤ë‰´ì–¼
â”‚   â””â”€â”€ API_REFERENCE.md              # API ë¬¸ì„œ
â”‚
â””â”€â”€ ğŸ“‚ legacy/                        # ê¸°ì¡´ ì½”ë“œ (ì°¸ê³ ìš©, Git ì œì™¸)
    â””â”€â”€ infra/                        # 2017ë…„ í”„ë¡œì íŠ¸
```

### 4.2 ì£¼ìš” íŒŒì¼ ì„¤ëª…

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `src/__main__.py` | ì§„ì…ì , `python -m src` ì‹¤í–‰ |
| `src/gui/app.py` | GUI ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ |
| `src/core/scanner/base_scanner.py` | ëª¨ë“  Scannerì˜ ê¸°ë³¸ í´ë˜ìŠ¤ |
| `src/application/scan_service.py` | ìŠ¤ìº” ê´€ë ¨ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ |
| `config/rules/linux/account.yaml` | Linux ê³„ì • ê´€ë¦¬ ê·œì¹™ |
| `tests/conftest.py` | pytest ê³µí†µ í”½ìŠ¤ì²˜ |

---

## 5. í•µì‹¬ ëª¨ë“ˆ ì„¤ê³„

### 5.1 Scanner ëª¨ë“ˆ

#### í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      BaseScanner (ABC)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ + connect()                      â”‚
â”‚ + disconnect()                   â”‚
â”‚ + scan() -> ScanResult           â”‚
â”‚ + execute_command(cmd) -> str    â”‚
â”‚ # _load_rules() -> List[Rule]    â”‚
â”‚ # _parse_result(raw) -> Result   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â–³
                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ UnixScanner      â”‚ â”‚WindowsScanner    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ # check_file_    â”‚ â”‚ # check_registry â”‚
â”‚   permission()   â”‚ â”‚ # check_service  â”‚
â”‚ # check_process  â”‚ â”‚ # check_firewall â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–³
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚Linux   â”‚ â”‚macOS    â”‚
â”‚Scanner â”‚ â”‚Scanner  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ì½”ë“œ ì˜ˆì‹œ

```python
# src/core/scanner/base_scanner.py
from abc import ABC, abstractmethod
from typing import List
from ..domain.scan_result import ScanResult
from ..domain.check_item import CheckItem

class BaseScanner(ABC):
    """ëª¨ë“  Scannerì˜ ê¸°ë³¸ í´ë˜ìŠ¤"""

    def __init__(self, server_info: dict):
        self.server_info = server_info
        self.rules: List[CheckItem] = []
        self.connection = None

    @abstractmethod
    async def connect(self) -> bool:
        """ì„œë²„ ì—°ê²° (SSH/WinRM)"""
        pass

    @abstractmethod
    async def disconnect(self) -> None:
        """ì—°ê²° ì¢…ë£Œ"""
        pass

    @abstractmethod
    async def execute_command(self, command: str) -> str:
        """ëª…ë ¹ì–´ ì‹¤í–‰"""
        pass

    async def scan(self) -> ScanResult:
        """ì „ì²´ ì ê²€ ì‹¤í–‰"""
        await self.connect()
        self._load_rules()

        results = []
        for rule in self.rules:
            result = await self._check_item(rule)
            results.append(result)

        await self.disconnect()
        return ScanResult(results=results)

    @abstractmethod
    def _load_rules(self) -> None:
        """í”Œë«í¼ë³„ ê·œì¹™ ë¡œë“œ"""
        pass

    async def _check_item(self, item: CheckItem) -> dict:
        """ê°œë³„ ì ê²€ í•­ëª© ì‹¤í–‰"""
        raw_output = await self.execute_command(item.command)
        is_compliant = self._validate(raw_output, item.validator)

        return {
            "item_id": item.id,
            "status": "pass" if is_compliant else "fail",
            "raw_output": raw_output
        }

    @abstractmethod
    def _validate(self, output: str, validator: str) -> bool:
        """ê²°ê³¼ ê²€ì¦"""
        pass
```

```python
# src/core/scanner/unix_scanner.py
import asyncio
from .base_scanner import BaseScanner

class UnixScanner(BaseScanner):
    """Linuxì™€ macOS ê³µí†µ ë¡œì§"""

    async def execute_command(self, command: str) -> str:
        """SSHë¡œ ëª…ë ¹ì–´ ì‹¤í–‰"""
        proc = await asyncio.create_subprocess_shell(
            command,
            stdout=asyncio.subprocess.PIPE,
            stderr=asyncio.subprocess.PIPE
        )
        stdout, stderr = await proc.communicate()
        return stdout.decode()

    def check_file_permission(self, file_path: str, expected_perm: str) -> bool:
        """íŒŒì¼ ê¶Œí•œ í™•ì¸ (Unix ê³µí†µ)"""
        output = await self.execute_command(f"ls -l {file_path}")
        # ê¶Œí•œ íŒŒì‹± ë¡œì§
        return actual_perm == expected_perm
```

```python
# src/core/scanner/linux_scanner.py
from .unix_scanner import UnixScanner
from ..scanner.rule_loader import RuleLoader

class LinuxScanner(UnixScanner):
    """Linux íŠ¹í™” Scanner"""

    def _load_rules(self) -> None:
        """Linux ê·œì¹™ ë¡œë“œ"""
        loader = RuleLoader(platform="linux")
        self.rules = loader.load_all()

    async def check_systemd_service(self, service_name: str) -> bool:
        """systemd ì„œë¹„ìŠ¤ í™•ì¸ (Linux ì „ìš©)"""
        output = await self.execute_command(f"systemctl status {service_name}")
        return "active" in output
```

```python
# src/core/scanner/macos_scanner.py
from .unix_scanner import UnixScanner

class MacOSScanner(UnixScanner):
    """macOS íŠ¹í™” Scanner"""

    def _load_rules(self) -> None:
        """macOS ê·œì¹™ ë¡œë“œ"""
        loader = RuleLoader(platform="macos")
        self.rules = loader.load_all()

    async def check_sip_status(self) -> bool:
        """SIP ìƒíƒœ í™•ì¸ (macOS ì „ìš©)"""
        output = await self.execute_command("csrutil status")
        return "enabled" in output.lower()

    async def check_gatekeeper(self) -> bool:
        """Gatekeeper í™•ì¸ (macOS ì „ìš©)"""
        output = await self.execute_command("spctl --status")
        return "assessments enabled" in output.lower()
```

#### Scanner Factory

```python
# src/core/scanner/scanner_factory.py
from .linux_scanner import LinuxScanner
from .macos_scanner import MacOSScanner
from .windows_scanner import WindowsScanner

class ScannerFactory:
    """Scanner íŒ©í† ë¦¬"""

    @staticmethod
    def create(platform: str, server_info: dict):
        """í”Œë«í¼ì— ë§ëŠ” Scanner ìƒì„±"""
        scanners = {
            "linux": LinuxScanner,
            "macos": MacOSScanner,
            "windows": WindowsScanner
        }

        scanner_class = scanners.get(platform.lower())
        if not scanner_class:
            raise ValueError(f"Unsupported platform: {platform}")

        return scanner_class(server_info)
```

### 5.2 Analyzer ëª¨ë“ˆ

```python
# src/core/analyzer/risk_calculator.py
from ..domain.enums import Severity

class RiskCalculator:
    """ìœ„í—˜ë„ ê³„ì‚°"""

    def calculate_score(self, scan_result) -> float:
        """ì „ì²´ ì ìˆ˜ ê³„ì‚° (0~100)"""
        total_items = len(scan_result.items)
        passed_items = sum(1 for item in scan_result.items if item.status == "pass")

        return (passed_items / total_items) * 100

    def get_severity_distribution(self, scan_result) -> dict:
        """ìœ„í—˜ë„ ë¶„í¬"""
        distribution = {
            Severity.HIGH: 0,
            Severity.MEDIUM: 0,
            Severity.LOW: 0
        }

        for item in scan_result.items:
            if item.status == "fail":
                distribution[item.severity] += 1

        return distribution
```

### 5.3 Remediation ëª¨ë“ˆ

```python
# src/core/remediation/base_remediator.py
from abc import ABC, abstractmethod
from typing import List
from ..domain.check_item import CheckItem
from .backup_manager import BackupManager

class BaseRemediator(ABC):
    """ìë™ ìˆ˜ì • ê¸°ë³¸ í´ë˜ìŠ¤"""

    def __init__(self, scanner, dry_run=True):
        self.scanner = scanner
        self.dry_run = dry_run
        self.backup_manager = BackupManager()

    async def remediate(self, items: List[CheckItem]) -> dict:
        """ìë™ ìˆ˜ì • ì‹¤í–‰"""
        results = {
            "total": len(items),
            "success": 0,
            "failed": 0,
            "skipped": 0
        }

        for item in items:
            if not item.auto_remediable:
                results["skipped"] += 1
                continue

            # ë°±ì—…
            if item.backup_files:
                await self.backup_manager.backup(item.backup_files)

            # ìˆ˜ì • ì‹¤í–‰
            try:
                if self.dry_run:
                    # Dry-run: ì‹œë®¬ë ˆì´ì…˜ë§Œ
                    success = self._simulate_fix(item)
                else:
                    success = await self._execute_fix(item)

                if success:
                    results["success"] += 1
                else:
                    results["failed"] += 1
                    # ë¡¤ë°±
                    if item.backup_files:
                        await self.backup_manager.rollback(item.backup_files)

            except Exception as e:
                results["failed"] += 1
                # ë¡¤ë°±
                if item.backup_files:
                    await self.backup_manager.rollback(item.backup_files)

        return results

    @abstractmethod
    async def _execute_fix(self, item: CheckItem) -> bool:
        """ì‹¤ì œ ìˆ˜ì • ì‹¤í–‰"""
        pass

    def _simulate_fix(self, item: CheckItem) -> bool:
        """ìˆ˜ì • ì‹œë®¬ë ˆì´ì…˜ (Dry-run)"""
        # ëª…ë ¹ì–´ ì‹¤í–‰í•˜ì§€ ì•Šê³  ê²€ì¦ë§Œ
        return True
```

```python
# src/core/remediation/backup_manager.py
import shutil
from datetime import datetime
from pathlib import Path

class BackupManager:
    """ë°±ì—… ê´€ë¦¬"""

    def __init__(self, backup_dir="/var/bluepy/backups"):
        self.backup_dir = Path(backup_dir)
        self.backup_dir.mkdir(parents=True, exist_ok=True)

    async def backup(self, files: List[str]) -> str:
        """íŒŒì¼ ë°±ì—…"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        backup_id = f"backup_{timestamp}"
        backup_path = self.backup_dir / backup_id
        backup_path.mkdir()

        for file_path in files:
            src = Path(file_path)
            dst = backup_path / src.name
            shutil.copy2(src, dst)

        return backup_id

    async def rollback(self, backup_id: str) -> bool:
        """ë°±ì—…ì—ì„œ ë³µì›"""
        backup_path = self.backup_dir / backup_id
        if not backup_path.exists():
            return False

        for file_path in backup_path.iterdir():
            # ì›ë˜ ìœ„ì¹˜ë¡œ ë³µì›
            # (ì‹¤ì œ êµ¬í˜„ ì‹œ ì›ë³¸ ê²½ë¡œ ë©”íƒ€ë°ì´í„° í•„ìš”)
            shutil.copy2(file_path, original_location)

        return True
```

---

## 6. ë°ì´í„° ëª¨ë¸

### 6.1 Domain Entities

```python
# src/core/domain/check_item.py
from dataclasses import dataclass
from typing import List, Optional
from .enums import Severity, Platform

@dataclass
class CheckItem:
    """ì ê²€ í•­ëª© ì—”í‹°í‹°"""
    id: str                           # ì˜ˆ: "U-01", "M-01"
    name: str                         # ì˜ˆ: "root ì›ê²© ë¡œê·¸ì¸ ì œí•œ"
    category: str                     # ì˜ˆ: "account_management"
    severity: Severity                # HIGH, MEDIUM, LOW
    platforms: List[Platform]         # [LINUX], [MACOS], etc.
    description: str                  # ì„¤ëª…
    commands: List[str]               # ì‹¤í–‰í•  ëª…ë ¹ì–´
    validator: str                    # ê²€ì¦ í•¨ìˆ˜ëª…
    auto_remediable: bool             # ìë™ ìˆ˜ì • ê°€ëŠ¥ ì—¬ë¶€
    remediation_steps: List[str]      # ìˆ˜ì • ë‹¨ê³„
    backup_files: List[str]           # ë°±ì—…í•  íŒŒì¼
    references: dict                  # KISA, CVE ë“± ì°¸ì¡°
    education: dict                   # êµìœ¡ ì½˜í…ì¸ 
```

```python
# src/core/domain/scan_result.py
from dataclasses import dataclass
from datetime import datetime
from typing import List
from .enums import Status

@dataclass
class CheckResult:
    """ê°œë³„ ì ê²€ ê²°ê³¼"""
    item_id: str
    status: Status                    # PASS, FAIL, HOLD
    raw_output: str                   # ëª…ë ¹ì–´ ì‹¤í–‰ ê²°ê³¼
    message: str                      # ì‚¬ìš©ì ë©”ì‹œì§€
    timestamp: datetime

@dataclass
class ScanResult:
    """ì „ì²´ ìŠ¤ìº” ê²°ê³¼"""
    scan_id: str
    server_id: str
    platform: Platform
    start_time: datetime
    end_time: datetime
    results: List[CheckResult]
    score: float                      # 0~100
    summary: dict                     # í†µê³„
```

```python
# src/core/domain/enums.py
from enum import Enum

class Severity(str, Enum):
    """ìœ„í—˜ë„"""
    HIGH = "high"
    MEDIUM = "medium"
    LOW = "low"

class Status(str, Enum):
    """ì ê²€ ìƒíƒœ"""
    PASS = "pass"        # ì•ˆì „
    FAIL = "fail"        # ì·¨ì•½
    HOLD = "hold"        # ìˆ˜ë™ í™•ì¸ í•„ìš”

class Platform(str, Enum):
    """í”Œë«í¼"""
    LINUX = "linux"
    MACOS = "macos"
    WINDOWS = "windows"
```

### 6.2 Infrastructure Models (ORM)

```python
# src/infrastructure/database/models.py
from sqlalchemy import Column, Integer, String, DateTime, Float, Text, ForeignKey, Enum
from sqlalchemy.orm import relationship
from sqlalchemy.ext.declarative import declarative_base
from datetime import datetime

Base = declarative_base()

class Server(Base):
    __tablename__ = "servers"

    id = Column(Integer, primary_key=True)
    name = Column(String(100), nullable=False)
    platform = Column(String(20), nullable=False)  # linux, macos, windows
    host = Column(String(255), nullable=False)
    port = Column(Integer, default=22)
    username = Column(String(100))
    # ë¹„ë°€ë²ˆí˜¸ëŠ” keyringì— ì €ì¥
    group = Column(String(50))  # ì˜ˆ: dev, prod, test
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)

    # ê´€ê³„
    scans = relationship("Scan", back_populates="server")

class Scan(Base):
    __tablename__ = "scans"

    id = Column(Integer, primary_key=True)
    scan_id = Column(String(50), unique=True)  # UUID
    server_id = Column(Integer, ForeignKey("servers.id"))
    platform = Column(String(20))
    start_time = Column(DateTime)
    end_time = Column(DateTime)
    score = Column(Float)  # 0~100
    total_items = Column(Integer)
    passed_items = Column(Integer)
    failed_items = Column(Integer)
    hold_items = Column(Integer)
    created_at = Column(DateTime, default=datetime.utcnow)

    # ê´€ê³„
    server = relationship("Server", back_populates="scans")
    results = relationship("CheckResultModel", back_populates="scan")

class CheckResultModel(Base):
    __tablename__ = "check_results"

    id = Column(Integer, primary_key=True)
    scan_id = Column(Integer, ForeignKey("scans.id"))
    item_id = Column(String(20))  # U-01, M-01 ë“±
    status = Column(String(20))  # pass, fail, hold
    raw_output = Column(Text)
    message = Column(Text)
    severity = Column(String(20))
    timestamp = Column(DateTime, default=datetime.utcnow)

    # ê´€ê³„
    scan = relationship("Scan", back_populates="results")
```

---

## 7. ê·œì¹™ ì‹œìŠ¤í…œ

### 7.1 YAML ê·œì¹™ êµ¬ì¡°

```yaml
# config/rules/linux/account.yaml

# U-01: root ì›ê²© ë¡œê·¸ì¸ ì œí•œ
- id: U-01
  name: root ì›ê²© ë¡œê·¸ì¸ ì œí•œ
  category: account_management
  severity: high
  platforms:
    - linux

  description: |
    root ê³„ì •ì˜ ì›ê²© ë¡œê·¸ì¸ì„ í—ˆìš©í•˜ë©´
    ë¬´ì°¨ë³„ ëŒ€ì… ê³µê²©(Brute Force Attack)ì— ì·¨ì•½í•©ë‹ˆë‹¤.

    ê³µê²©ìê°€ root ë¹„ë°€ë²ˆí˜¸ë§Œ ì•Œì•„ë‚´ë©´
    ì‹œìŠ¤í…œ ì „ì²´ë¥¼ ì¥ì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  check:
    commands:
      - cat /etc/pam.d/login | grep pam_securetty
      - cat /etc/securetty | grep pts
    validator: check_root_remote_login
    # validator í•¨ìˆ˜ê°€ Trueë¥¼ ë°˜í™˜í•˜ë©´ PASS

  remediation:
    auto: true
    backup_files:
      - /etc/pam.d/login
      - /etc/securetty
    steps:
      - |
        # /etc/pam.d/loginì— pam_securetty ëª¨ë“ˆ ì¶”ê°€
        if ! grep -q "pam_securetty" /etc/pam.d/login; then
          echo "auth required /lib/security/pam_securetty.so" >> /etc/pam.d/login
        fi
      - |
        # /etc/securettyì—ì„œ pts ì œê±°
        sed -i '/^pts/d' /etc/securetty
    rollback_safe: true

  education:
    risk_level: ì¹˜ëª…ì 
    attack_scenario: |
      1. ê³µê²©ìê°€ ì¸í„°ë„·ì—ì„œ ì„œë²„ IP íƒìƒ‰
      2. SSHë¡œ root ë¡œê·¸ì¸ ì‹œë„ (ë¬´ì°¨ë³„ ëŒ€ì…)
      3. ë¹„ë°€ë²ˆí˜¸ íšë“ ì‹œ ì „ì²´ ì‹œìŠ¤í…œ ì¥ì•…
      4. ë°±ë„ì–´ ì„¤ì¹˜, ë°ì´í„° íƒˆì·¨

    fix_guide: |
      ### ìˆ˜ë™ ìˆ˜ì • ë°©ë²•

      1. /etc/pam.d/login íŒŒì¼ í¸ì§‘
         ```bash
         sudo vi /etc/pam.d/login
         ```

      2. ë‹¤ìŒ ë¼ì¸ ì¶”ê°€
         ```
         auth required /lib/security/pam_securetty.so
         ```

      3. /etc/securettyì—ì„œ pts ì œê±°
         ```bash
         sudo sed -i '/^pts/d' /etc/securetty
         ```

      4. ê²€ì¦
         ```bash
         grep pam_securetty /etc/pam.d/login
         ```

    related_cves: []

  references:
    kisa: U-01
    cis: "5.2.8 Ensure SSH root login is disabled"
    nist: "IA-2"

# U-02: íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ë„ ì„¤ì •
- id: U-02
  name: íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ë„ ì„¤ì •
  category: account_management
  severity: high
  platforms:
    - linux

  # ... (ìœ ì‚¬í•œ êµ¬ì¡°)
```

### 7.2 Rule Loader

```python
# src/core/scanner/rule_loader.py
import yaml
from pathlib import Path
from typing import List
from ..domain.check_item import CheckItem
from ..domain.enums import Severity, Platform

class RuleLoader:
    """YAML ê·œì¹™ íŒŒì¼ ë¡œë”"""

    def __init__(self, platform: str, rules_dir: str = "config/rules"):
        self.platform = platform
        self.rules_dir = Path(rules_dir) / platform

    def load_all(self) -> List[CheckItem]:
        """ëª¨ë“  ê·œì¹™ ë¡œë“œ"""
        rules = []

        for yaml_file in self.rules_dir.glob("*.yaml"):
            rules.extend(self._load_file(yaml_file))

        return rules

    def _load_file(self, file_path: Path) -> List[CheckItem]:
        """ê°œë³„ YAML íŒŒì¼ ë¡œë“œ"""
        with open(file_path, 'r', encoding='utf-8') as f:
            data = yaml.safe_load(f)

        return [self._parse_rule(rule_dict) for rule_dict in data]

    def _parse_rule(self, rule_dict: dict) -> CheckItem:
        """YAML ë”•ì…”ë„ˆë¦¬ë¥¼ CheckItemìœ¼ë¡œ ë³€í™˜"""
        return CheckItem(
            id=rule_dict['id'],
            name=rule_dict['name'],
            category=rule_dict['category'],
            severity=Severity(rule_dict['severity']),
            platforms=[Platform(p) for p in rule_dict['platforms']],
            description=rule_dict['description'],
            commands=rule_dict['check']['commands'],
            validator=rule_dict['check']['validator'],
            auto_remediable=rule_dict['remediation']['auto'],
            remediation_steps=rule_dict['remediation']['steps'],
            backup_files=rule_dict['remediation'].get('backup_files', []),
            references=rule_dict['references'],
            education=rule_dict['education']
        )
```

### 7.3 Validator ì‹œìŠ¤í…œ

```python
# src/core/analyzer/validator.py
import re

class Validator:
    """ê·œì¹™ ê²€ì¦ í•¨ìˆ˜ ëª¨ìŒ"""

    @staticmethod
    def check_root_remote_login(outputs: List[str]) -> bool:
        """U-01: root ì›ê²© ë¡œê·¸ì¸ ê²€ì¦"""
        pam_output, securetty_output = outputs

        # pam_securettyê°€ ìˆì–´ì•¼ í•¨
        has_pam = "pam_securetty" in pam_output

        # ptsê°€ ì—†ì–´ì•¼ í•¨
        has_pts = "pts" in securetty_output

        return has_pam and not has_pts

    @staticmethod
    def check_password_complexity(outputs: List[str]) -> bool:
        """U-02: íŒ¨ìŠ¤ì›Œë“œ ë³µì¡ë„ ê²€ì¦"""
        output = outputs[0]

        # pam_cracklib ë˜ëŠ” pam_pwqualityê°€ ìˆì–´ì•¼ í•¨
        return "pam_cracklib" in output or "pam_pwquality" in output

    @staticmethod
    def check_file_permission(outputs: List[str], expected: str) -> bool:
        """íŒŒì¼ ê¶Œí•œ ê²€ì¦ (ë²”ìš©)"""
        output = outputs[0]

        # ls -l ì¶œë ¥ íŒŒì‹±
        # ì˜ˆ: -rw-r--r--. 1 root root 1320 3ì›” 13 2017 /etc/passwd
        match = re.search(r'^([rwx-]{10})', output)
        if not match:
            return False

        actual_perm = match.group(1)
        return actual_perm == expected

    # macOS ì „ìš©
    @staticmethod
    def check_sip_enabled(outputs: List[str]) -> bool:
        """M-01: SIP í™œì„±í™” ê²€ì¦"""
        output = outputs[0].lower()
        return "enabled" in output

    @staticmethod
    def check_gatekeeper(outputs: List[str]) -> bool:
        """M-02: Gatekeeper ê²€ì¦"""
        output = outputs[0].lower()
        return "assessments enabled" in output
```

---

## 8. í†µì‹  ë° ë„¤íŠ¸ì›Œí¬

### 8.1 SSH í´ë¼ì´ì–¸íŠ¸

```python
# src/infrastructure/network/ssh_client.py
import asyncssh
from typing import Optional

class SSHClient:
    """AsyncSSH ë˜í¼"""

    def __init__(self, host: str, port: int, username: str, password: str):
        self.host = host
        self.port = port
        self.username = username
        self.password = password
        self.conn: Optional[asyncssh.SSHClientConnection] = None

    async def connect(self) -> bool:
        """SSH ì—°ê²°"""
        try:
            self.conn = await asyncssh.connect(
                self.host,
                port=self.port,
                username=self.username,
                password=self.password,
                known_hosts=None  # í”„ë¡œë•ì…˜ì—ì„œëŠ” ê²€ì¦ í•„ìš”
            )
            return True
        except Exception as e:
            print(f"Connection failed: {e}")
            return False

    async def execute(self, command: str, sudo: bool = False) -> tuple[str, str]:
        """ëª…ë ¹ì–´ ì‹¤í–‰"""
        if sudo:
            command = f"echo {self.password} | sudo -S {command}"

        result = await self.conn.run(command)
        return result.stdout, result.stderr

    async def disconnect(self):
        """ì—°ê²° ì¢…ë£Œ"""
        if self.conn:
            self.conn.close()
            await self.conn.wait_closed()
```

### 8.2 WinRM í´ë¼ì´ì–¸íŠ¸

```python
# src/infrastructure/network/winrm_client.py
import winrm

class WinRMClient:
    """PyWinRM ë˜í¼"""

    def __init__(self, host: str, username: str, password: str):
        self.host = host
        self.username = username
        self.password = password
        self.session = None

    def connect(self) -> bool:
        """WinRM ì—°ê²°"""
        try:
            self.session = winrm.Session(
                f'https://{self.host}:5986/wsman',
                auth=(self.username, self.password),
                server_cert_validation='ignore'  # í”„ë¡œë•ì…˜ì—ì„œëŠ” ê²€ì¦ í•„ìš”
            )
            # ì—°ê²° í…ŒìŠ¤íŠ¸
            result = self.session.run_cmd('echo test')
            return result.status_code == 0
        except Exception as e:
            print(f"Connection failed: {e}")
            return False

    def execute_powershell(self, script: str) -> tuple[str, str]:
        """PowerShell ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰"""
        result = self.session.run_ps(script)
        return result.std_out.decode(), result.std_err.decode()

    def disconnect(self):
        """ì—°ê²° ì¢…ë£Œ"""
        # WinRM ì„¸ì…˜ì€ ìë™ìœ¼ë¡œ ì •ë¦¬ë¨
        self.session = None
```

---

## 9. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 9.1 ERD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Server      â”‚       â”‚      Scan       â”‚       â”‚  CheckResult     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)         â”‚1    âˆâ”‚ id (PK)         â”‚1    âˆâ”‚ id (PK)          â”‚
â”‚ name            â”‚â”€â”€â”€â”€â”€â”€â”€â”‚ scan_id (UK)    â”‚â”€â”€â”€â”€â”€â”€â”€â”‚ scan_id (FK)     â”‚
â”‚ platform        â”‚       â”‚ server_id (FK)  â”‚       â”‚ item_id          â”‚
â”‚ host            â”‚       â”‚ platform        â”‚       â”‚ status           â”‚
â”‚ port            â”‚       â”‚ start_time      â”‚       â”‚ raw_output       â”‚
â”‚ username        â”‚       â”‚ end_time        â”‚       â”‚ message          â”‚
â”‚ group           â”‚       â”‚ score           â”‚       â”‚ severity         â”‚
â”‚ created_at      â”‚       â”‚ total_items     â”‚       â”‚ timestamp        â”‚
â”‚ updated_at      â”‚       â”‚ passed_items    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ failed_items    â”‚
                          â”‚ hold_items      â”‚
                          â”‚ created_at      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 ìŠ¤í‚¤ë§ˆ ìƒì„± (SQLite)

```sql
-- servers í…Œì´ë¸”
CREATE TABLE servers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name VARCHAR(100) NOT NULL,
    platform VARCHAR(20) NOT NULL,  -- linux, macos, windows
    host VARCHAR(255) NOT NULL,
    port INTEGER DEFAULT 22,
    username VARCHAR(100),
    group_name VARCHAR(50),
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- scans í…Œì´ë¸”
CREATE TABLE scans (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    scan_id VARCHAR(50) UNIQUE NOT NULL,  -- UUID
    server_id INTEGER NOT NULL,
    platform VARCHAR(20),
    start_time DATETIME,
    end_time DATETIME,
    score REAL,  -- 0~100
    total_items INTEGER,
    passed_items INTEGER,
    failed_items INTEGER,
    hold_items INTEGER,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (server_id) REFERENCES servers(id)
);

-- check_results í…Œì´ë¸”
CREATE TABLE check_results (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    scan_id INTEGER NOT NULL,
    item_id VARCHAR(20),  -- U-01, M-01 ë“±
    status VARCHAR(20),  -- pass, fail, hold
    raw_output TEXT,
    message TEXT,
    severity VARCHAR(20),  -- high, medium, low
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (scan_id) REFERENCES scans(id)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_scans_server_id ON scans(server_id);
CREATE INDEX idx_scans_created_at ON scans(created_at);
CREATE INDEX idx_check_results_scan_id ON check_results(scan_id);
CREATE INDEX idx_check_results_status ON check_results(status);
```

### 9.3 Repository íŒ¨í„´

```python
# src/infrastructure/database/repositories/scan_repository.py
from sqlalchemy.orm import Session
from typing import List, Optional
from ..models import Scan, CheckResultModel
from ...core.domain.scan_result import ScanResult

class ScanRepository:
    """Scan ì €ì¥ì†Œ"""

    def __init__(self, session: Session):
        self.session = session

    def save(self, scan_result: ScanResult) -> int:
        """ScanResult ì €ì¥"""
        # Domain Entity â†’ ORM Model ë³€í™˜
        scan = Scan(
            scan_id=scan_result.scan_id,
            server_id=scan_result.server_id,
            platform=scan_result.platform.value,
            start_time=scan_result.start_time,
            end_time=scan_result.end_time,
            score=scan_result.score,
            total_items=len(scan_result.results),
            passed_items=sum(1 for r in scan_result.results if r.status == "pass"),
            failed_items=sum(1 for r in scan_result.results if r.status == "fail"),
            hold_items=sum(1 for r in scan_result.results if r.status == "hold")
        )

        self.session.add(scan)
        self.session.flush()  # ID ìƒì„±

        # CheckResult ì €ì¥
        for result in scan_result.results:
            check_result = CheckResultModel(
                scan_id=scan.id,
                item_id=result.item_id,
                status=result.status.value,
                raw_output=result.raw_output,
                message=result.message,
                severity=result.severity.value,
                timestamp=result.timestamp
            )
            self.session.add(check_result)

        self.session.commit()
        return scan.id

    def find_by_id(self, scan_id: int) -> Optional[ScanResult]:
        """IDë¡œ Scan ì¡°íšŒ"""
        scan = self.session.query(Scan).filter(Scan.id == scan_id).first()
        if not scan:
            return None

        # ORM Model â†’ Domain Entity ë³€í™˜
        return self._to_domain(scan)

    def find_by_server(self, server_id: int, limit: int = 10) -> List[ScanResult]:
        """ì„œë²„ë³„ Scan ì¡°íšŒ (ìµœê·¼ìˆœ)"""
        scans = self.session.query(Scan)\
            .filter(Scan.server_id == server_id)\
            .order_by(Scan.created_at.desc())\
            .limit(limit)\
            .all()

        return [self._to_domain(scan) for scan in scans]

    def _to_domain(self, scan: Scan) -> ScanResult:
        """ORM Modelì„ Domain Entityë¡œ ë³€í™˜"""
        # ... ë³€í™˜ ë¡œì§
        pass
```

---

## 10. ë³´ì•ˆ ì„¤ê³„

### 10.1 í¬ë ˆë´ì…œ ê´€ë¦¬

```python
# src/utils/crypto.py
import keyring
from cryptography.fernet import Fernet

class CredentialManager:
    """í¬ë ˆë´ì…œ ì•ˆì „ ì €ì¥"""

    SERVICE_NAME = "bluepy"

    @staticmethod
    def save_password(server_id: str, password: str):
        """ë¹„ë°€ë²ˆí˜¸ ì €ì¥ (OS Keyring ì‚¬ìš©)"""
        keyring.set_password(
            CredentialManager.SERVICE_NAME,
            server_id,
            password
        )

    @staticmethod
    def get_password(server_id: str) -> str:
        """ë¹„ë°€ë²ˆí˜¸ ì¡°íšŒ"""
        return keyring.get_password(
            CredentialManager.SERVICE_NAME,
            server_id
        )

    @staticmethod
    def delete_password(server_id: str):
        """ë¹„ë°€ë²ˆí˜¸ ì‚­ì œ"""
        keyring.delete_password(
            CredentialManager.SERVICE_NAME,
            server_id
        )
```

### 10.2 ê°ì‚¬ ë¡œê·¸

```python
# src/utils/logger.py
import logging
from logging.handlers import RotatingFileHandler

def setup_audit_logger():
    """ê°ì‚¬ ë¡œê·¸ ì„¤ì •"""
    audit_logger = logging.getLogger('audit')
    audit_logger.setLevel(logging.INFO)

    handler = RotatingFileHandler(
        'logs/audit.log',
        maxBytes=10*1024*1024,  # 10MB
        backupCount=5
    )

    formatter = logging.Formatter(
        '%(asctime)s - %(levelname)s - %(message)s'
    )
    handler.setFormatter(formatter)
    audit_logger.addHandler(handler)

    return audit_logger

# ì‚¬ìš© ì˜ˆì‹œ
audit = setup_audit_logger()
audit.info(f"User {user_id} started scan on server {server_id}")
audit.info(f"User {user_id} executed remediation on {item_id}")
```

---

## 11. í™•ì¥ì„± ì „ëµ

### 11.1 í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ

```python
# src/core/scanner/plugin_manager.py
import importlib
from pathlib import Path

class PluginManager:
    """í”ŒëŸ¬ê·¸ì¸ ê´€ë¦¬"""

    def __init__(self, plugin_dir="plugins"):
        self.plugin_dir = Path(plugin_dir)
        self.plugins = {}

    def load_plugins(self):
        """í”ŒëŸ¬ê·¸ì¸ ë¡œë“œ"""
        for py_file in self.plugin_dir.glob("*.py"):
            module_name = py_file.stem
            spec = importlib.util.spec_from_file_location(module_name, py_file)
            module = importlib.util.module_from_spec(spec)
            spec.loader.exec_module(module)

            # Scanner í´ë˜ìŠ¤ ì°¾ê¸°
            if hasattr(module, 'Scanner'):
                self.plugins[module_name] = module.Scanner

    def get_plugin(self, name: str):
        """í”ŒëŸ¬ê·¸ì¸ ì¡°íšŒ"""
        return self.plugins.get(name)
```

### 11.2 ì»¤ìŠ¤í…€ ê·œì¹™

ì‚¬ìš©ìê°€ `config/rules/custom/` í´ë”ì— ìì‹ ë§Œì˜ YAML ê·œì¹™ì„ ì¶”ê°€ ê°€ëŠ¥:

```yaml
# config/rules/custom/my_custom_check.yaml
- id: C-01
  name: ë‚´ë¶€ ë³´ì•ˆ ì •ì±… í™•ì¸
  category: custom
  severity: medium
  platforms:
    - linux

  check:
    commands:
      - cat /etc/company_policy.conf
    validator: check_company_policy

  # ...
```

---

## 12. ì„±ëŠ¥ ìµœì í™”

### 12.1 ë¹„ë™ê¸° ìŠ¤ìº”

```python
# ë³‘ë ¬ ìŠ¤ìº”
async def scan_multiple_items(items: List[CheckItem]):
    """ì—¬ëŸ¬ í•­ëª©ì„ ë™ì‹œì— ì ê²€"""
    tasks = [scan_single_item(item) for item in items]
    results = await asyncio.gather(*tasks)
    return results
```

### 12.2 ìºì‹±

```python
# src/core/scanner/cache.py
from functools import lru_cache

@lru_cache(maxsize=100)
def get_os_version(host: str) -> str:
    """OS ë²„ì „ ìºì‹± (ì ê²€ ì¤‘ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë˜ë¯€ë¡œ)"""
    # ... SSHë¡œ uname -a ì‹¤í–‰
    pass
```

### 12.3 ì—°ê²° í’€

```python
# src/infrastructure/network/connection_pool.py
class ConnectionPool:
    """SSH ì—°ê²° í’€ ê´€ë¦¬"""

    def __init__(self, max_connections=5):
        self.pool = {}
        self.max_connections = max_connections

    async def get_connection(self, server_id: str):
        """ì—°ê²° ê°€ì ¸ì˜¤ê¸° (ì¬ì‚¬ìš©)"""
        if server_id in self.pool:
            return self.pool[server_id]

        # ìƒˆ ì—°ê²° ìƒì„±
        conn = await create_ssh_connection(server_id)
        self.pool[server_id] = conn
        return conn
```

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ ë‚´ìš© | ì‘ì„±ì |
|------|------|----------|--------|
| 2025-10-17 | 1.0 | ì´ˆì•ˆ ì‘ì„± | Claude |

---

**ë¬¸ì„œ ë**